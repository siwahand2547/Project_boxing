<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ตารางการแข่งขัน</title>
<script src="/socket.io/socket.io.js"></script>
<style>
  body { font-family: Arial; background: #121212; color: #eee; padding: 20px; }
  table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
  th, td { border: 1px solid #555; padding: 8px; text-align: center; }
  th { background-color: #333; }
  .bt-data { display: flex; gap: 20px; }
  .bt-box { flex: 1; background: #222; padding: 10px; max-height: 200px; overflow-y: auto; font-family: monospace; }
  .bt-port { font-weight: bold; }
</style>
</head>
<body>

<h1>ตารางการแข่งขัน</h1>

<table>
  <thead>
    <tr>
      <th>คู่ที่</th>
      <th>วันที่แข่งขัน</th>
      <th>นักชกคนที่ 1</th>
      <th>นักชกคนที่ 2</th>
      <th>เปรียบเทียบข้อมูล</th> <!-- ✅ เพิ่มคอลัมน์ใหม่ -->
    </tr>
  </thead>
  <tbody>
    <% fights.forEach((fight, index) => { %>
      <tr>
        <td><%= index + 1 %></td>
        <td><%= fight.fight_date.toISOString().slice(0, 10) %></td>
        <td><%= fight.fighter1 %></td>
        <td><%= fight.fighter2 %></td>
        <td>
          <a href="/fights/data/<%= fight.id %>" style="color: cyan;">ดูข้อมูล</a> <!-- ✅ เพิ่มปุ่มลิงก์ -->
        </td>
      </tr>
    <% }) %>
  </tbody>
</table>


<h2>ข้อมูล Bluetooth Real-time</h2>
<div class="bt-data">
  <div class="bt-box" id="btCOM4">
    <h3>นักชกคนที่ 1 (COM4)</h3>
    <div id="com4Data"></div>
  </div>
  <div class="bt-box" id="btCOM5">
    <h3>นักชกคนที่ 2 (COM5)</h3>
    <div id="com5Data"></div>
  </div>
</div>

<script>
  const socket = io();

  const com4Div = document.getElementById('com4Data');
  const com5Div = document.getElementById('com5Data');

  socket.on('com4Data', (data) => {
    const p = document.createElement('p');
    p.innerHTML = `<span class="bt-port">COM4:</span> ${data}`;
    com4Div.appendChild(p);
    com4Div.scrollTop = com4Div.scrollHeight;
  });

  socket.on('com5Data', (data) => {
    const p = document.createElement('p');
    p.innerHTML = `<span class="bt-port">COM5:</span> ${data}`;
    com5Div.appendChild(p);
    com5Div.scrollTop = com5Div.scrollHeight;
  });
</script>

</body>
</html>
